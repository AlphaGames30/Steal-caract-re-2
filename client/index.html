<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Steal-a-Thing 3D Jouable</title>
<style>
  body { margin: 0; overflow: hidden; }
</style>
</head>
<body>

<script type="module">
import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.153.0/build/three.module.js';

// --- Scène ---
const scene = new THREE.Scene();
scene.background = new THREE.Color(0xa0a0a0);

// --- Caméra ---
const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 200);
camera.position.set(0, 10, 20);

// --- Renderer ---
const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// --- Lumières ---
const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
scene.add(ambientLight);
const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
dirLight.position.set(10, 30, 10);
scene.add(dirLight);

// --- Sol vert ---
const solGeo = new THREE.PlaneGeometry(60, 40);
const solMat = new THREE.MeshStandardMaterial({ color: 0x228B22 });
const sol = new THREE.Mesh(solGeo, solMat);
sol.rotation.x = -Math.PI/2;
scene.add(sol);

// --- Tapis central ---
const tapisGeo = new THREE.PlaneGeometry(40, 30);
const tapisMat = new THREE.MeshStandardMaterial({ color: 0x7CFC00 });
const tapis = new THREE.Mesh(tapisGeo, tapisMat);
tapis.position.y = 0.01;
tapis.rotation.x = -Math.PI/2;
scene.add(tapis);

// --- Murs autour de tout le playset ---
function createWall(x, y, z, w, h, d, color){
  const geo = new THREE.BoxGeometry(w,h,d);
  const mat = new THREE.MeshStandardMaterial({ color });
  const mesh = new THREE.Mesh(geo, mat);
  mesh.position.set(x,y,z);
  scene.add(mesh);
}

// Couches : gris bas, marron milieu, vert fin dessus
const wallHeight = [1,1,0.2];
const wallColors = [0x808080, 0x8B4513, 0x228B22];
const halfWidth = 60/2;
const halfDepth = 40/2;

for(let i=0;i<3;i++){
  const y = wallHeight[i]/2 + (i>0 ? wallHeight[i-1]:0);
  // Murs X (avant/arrière)
  createWall(0,y,-halfDepth,60,wallHeight[i],0.5,wallColors[i]);
  createWall(0,y,halfDepth,60,wallHeight[i],0.5,wallColors[i]);
  // Murs Z (gauche/droite)
  createWall(-halfWidth,y,0,0.5,wallHeight[i],40,wallColors[i]);
  createWall(halfWidth,y,0,0.5,wallHeight[i],40,wallColors[i]);
}

// --- Bases : 4 à gauche, 4 à droite ---
const BASES = 4;
const SLOTS = 6;
const baseWidth = 3;
const baseDepth = 2;
const slotSpacing = 1.2;

for(let b=0;b<BASES;b++){
  for(let s=0;s<SLOTS;s++){
    // Gauche
    const slotGeo = new THREE.BoxGeometry(baseWidth,1,baseDepth);
    const slotMat = new THREE.MeshStandardMaterial({ color:0xaaaaaa });
    const slot = new THREE.Mesh(slotGeo, slotMat);
    slot.position.set(-25 + b*(baseWidth+1),0.5,-7 + s*(baseDepth+slotSpacing));
    scene.add(slot);
    // Droite
    const slot2 = new THREE.Mesh(slotGeo, slotMat.clone());
    slot2.position.set(25 - b*(baseWidth+1),0.5,-7 + s*(baseDepth+slotSpacing));
    scene.add(slot2);
  }
}

// --- Personnage contrôlable ---
const playerGeo = new THREE.BoxGeometry(1,2,1);
const playerMat = new THREE.MeshStandardMaterial({ color:0x0000ff });
const player = new THREE.Mesh(playerGeo, playerMat);
player.position.set(0,1,12);
scene.add(player);

// --- Déplacements ---
const keys = {};
document.addEventListener('keydown', e=>keys[e.key.toLowerCase()] = true);
document.addEventListener('keyup', e=>keys[e.key.toLowerCase()] = false);

const speed = 0.2;

// --- Animation ---
function animate(){
  requestAnimationFrame(animate);

  // Contrôle joueur
  if(keys['w'] || keys['arrowup']) player.position.z -= speed;
  if(keys['s'] || keys['arrowdown']) player.position.z += speed;
  if(keys['a'] || keys['arrowleft']) player.position.x -= speed;
  if(keys['d'] || keys['arrowright']) player.position.x += speed;

  // Caméra derrière le joueur
  camera.position.x = player.position.x;
  camera.position.z = player.position.z + 8;
  camera.position.y = player.position.y + 5;
  camera.lookAt(player.position);

  renderer.render(scene,camera);
}

animate();

// --- Resize ---
window.addEventListener('resize',()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
});
</script>
</body>
</html>
